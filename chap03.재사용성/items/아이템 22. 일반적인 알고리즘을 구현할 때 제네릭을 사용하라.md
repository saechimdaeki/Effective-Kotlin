# 아이템 22. 일반적인 알고리즘을 구현할 때 제네릭을 사용하라

아규먼트로 함수에 값을 전달할 수 있는 것처럼, 타입 아규먼트를 사용하면 함수에 타입을 전달할 수 있다. 타입 아규먼트를 사용하는 함수(즉 타입 파라미터를 갖는 함수)를

`제네릭 함수`(generic function)라고 부른다. 대표적인 예로는 stdlib에 있는 `filter`함수가 있다. `filter`함수는 타입 파라미터 T를 갖는다

```kotlin
inline fun <T> Iterable<T>.filter(
    predicate: (T) -> Boolean
): List<T> {
    val destination = ArrayList<T>()
    for (element in this) {
        if(predicate(element)) {
            destination.add(element)
        }
    }
    return destination
}
```

타입 파라미터는 컴팡일러에 타입과 관련된 정보를 제공하여 컴파일러가 타입을 조금이라도 더 정확하게 추측할 수 있게 해준다. 따라서 프로그램이 조금 더 안전해지고,

개발자는 프로그래밍이 편해진다. 예를 들어 `filter`함수에서 람다 표현식 내부를 생각해보자. 컴파일러가 아규먼트를 컬렉션의 요소와 같은 타입이라는 것을

알 수 있으므로, 잘못 처리하는 것을 막을 수 잇다.

제네릭은 기본적으로 List< String> 또는 Set< User> 처럼 구체적인 타입으로 컬렉션을 만들 수 있게 클래스와 인터페이스에 도입된 기능이다.

물론 컴파일 과정에서 최종적으로 이러한 타입 정보는 사라지지만, 개발 중에는 특정 타입을 사용하게 강제할 수 있다. 이러한 타입 정보 덕분에 MutableList< Int> 에 

안전하게 Int를 추가할 수 있다. 또한 Set< User>에서 요소를꺼내면, 그것이 User라는 것을 알 수 있다. 이와 같은 기능은 정적 타입 프로그래밍 언어에서는

굉장히 유용하게 활용된다. 코틀린은 강력한 제네릭 기능을 갖고 있지만, 조금 복잡해서 이해하기 어렵다. 코틀린 제네릭의 중요한 특징들에 대해서는 아이템 24를 통해 살펴보자

## 제네릭 제한
타입 파라미터의 중요한 기능 중 하나는 구체적인 타입의 서브타입만 사용하게 타입을 제한하는 것이다. 다음 코드를 살펴보자.

콜론 뒤에 슈퍼타입을 설정해서 제한을 걸었다.

```kotlin
fun <T: Comparable<T>> Iterable<T>.sorted(): List<T> {
    /*...*/
}

fun <T, C: MutableCollection<in T>>
Iterable<T>.toCollection(destination: C): C {
    /*...*/
}

class ListAdapter<T: ItemAdapter>(/*...*/){/*...*/}
```

타입에 제한이 걸리므로, 내부에서 해당 타입이 제공하는 메서드를 사용할 수 있다. 예를 들어 T를 Iterable< Int>의 서브타입으로 제한하면, T 타입을 기반으로

반복 처리가 가능하고, 반복 처리 때 사용되는 객체가 Int라는 것을 알 수 있다. 또한 Comparable< T>로 제한하면, 해당 타입을 비교할 수 있다는 것을 알 수 있다.

많이 사용하는 제한으로는 Any가 있다. 이는 nullable이 아닌 타입을 나타낸다.

```kotlin
inline fun <T, R: Any> Iterable<T>.mapNotNull(
    transform: (T) -> R?
): List<R> {
    return mapNotNullTo(ArrayList<R>(), transform)
}
```

드물지만 다음과 같이 둘 이상의 제한을 걸 수도 있다.

```kotlin
fun <T: Animal> pet(animal: T) where T: GoodTempered {
    /*...*/
}

// 또는

fun <T> pet(animal: T) where T: Animal, T: GoodTempered {
    /*...*/
}
```

# 아이템 22 - 정리
코틀린 자료형 시스템에서 타입 파라미터는 굉장히 중요한 부분이다. 일반적으로 이를 사용해서 type-safe 제네릭 알고리즘과 제네릭 객체를

구현한다. 타입 파라미터는 구체 자료형(concrete type)의 서브타입을 제한할 수 있다. 이렇게 하면 특정 자료형이 제공하는 메서드를 안전하게 사용할 수 있다.